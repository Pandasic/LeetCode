"""
5178. 四因数 显示英文描述 
用户通过次数9
用户尝试次数14
通过次数9
提交次数17
题目难度Medium
给你一个整数数组 nums，请你返回该数组中恰有四个因数的这些整数的各因数之和。

如果数组中不存在满足题意的整数，则返回 0 。

 

示例：

输入：nums = [21,4,7]
输出：32
解释：
21 有 4 个因数：1, 3, 7, 21
4 有 3 个因数：1, 2, 4
7 有 2 个因数：1, 7
答案仅为 21 的所有因数的和。
 

提示：

1 <= nums.length <= 10^4
1 <= nums[i] <= 10^5
"""
#算出来总是比 标准答案大 = =
#看看大佬解析吧a == 

class Solution:
    def __init__(self):
        self.primer = []

    def sumFourDivisors(self, nums) -> int:
        res = 0
        self.getPrimeNums(max(nums))

        for v in nums:
            parts = set()
            for p in self.primer:
                if p >= v:
                    break
                if v%p == 0:
                    parts.add(p)
                    parts.add(v//p)
                if len(parts) > 4:
                    break
            if len(parts) == 4:
                res += sum(list(parts))

        return res

    def getPrimeNums(self,num):
        nums = [i for i in range(num+1)]
        for i in range(2,num):
            if nums[i] != 0:
                for r in range(i*2,num+1,i):
                    nums[r] = 0
        self.primer = [v for v in nums if v != 0]

 
s = Solution()
print(s.sumFourDivisors([5004,8651,91386,72867,19464,65421,86643,10113,87594,47243,39452,64413,29490,62638,31819,15927,73175,81386,18800,380,76033,88552,58023,87075,58914,38053,59261,35621,18042,70624,29763,84676,12088,98996,89104,42150,51458,36015,22784,156,34452,68060,59554,70008,16178,33195,39164,28158,52456,61847,56741,24627,55638,25118,63311,66468,71783,4831,47765,85576,54001,10043,78322,93408,78776,31099,67394,59676,58674,67569,76259,21116,69723,57129,91473,33192,92580,59184,46857,67909,67124,36838,17908,48389,30803,63660,3302,72327,90775,62125,60447,40110,97565,34657,87256,33023,76273,29492,11684,50313,45123,14949,63756,80129,67894,30734,477,32907,28981,48688,44470,5570,82488,74037,4510,32548,88153,75043,74681,25823,55799,58851,52438,48059,32596,72475,11953,41926,87897,64986,53203,54131,17622,6948,89084,10813,57591,42917,62827,73499,69620,19265,82383,62561,71874,71139,27758,76792,73482,99389,18329,56665,89602,83731,16356,80679,35981,42443,76604,27109,36738,71180,25454,64346,37037,64016,85144,98199,84079,93928,72083,15582,99057,68895,70145,62442,95030,93788,49699,78337,50523,22050,70846,30670,44686,54220,72986,13301,350,32119,29316,49876,11231,93673,62677,45809,44301,78202,73666,48621,32820,35932,10383,67866,41,76016,3317,11420,65615,27343,14284,19063,74517,84340,13584,27619,87743,73654,25611,98348,99575,21551,45974,63810,99199,73386,20468,93591,9201,17923,22515,73039,32148,84026,70233,42763,7208,38603,28381,11796,47630,29282,66961,84934,48117,40278,11758,86966,75729,61207,69284,73127,2266,21574,16951,69646,83998,48607,17511,78748,1908,74522,97689,72602,38086,77200,6322,85154,38810,63762,77984,13167,19079,53561,21338,64906,22495,24366,49892,31470,28676,48506,40890,15713,10219,89107,73961,37071,52479,90433,30854,82768,64264,85145,41340,58062,62596,98429,86217,31208,33323,25815,5165,70738,89891,30522,79418,10331,29950,31267,41175,73546,79338,3814,17617,52314,7046,49007,93746,27758,59594,79851,19153,52884,76542,34159,77342,32680,42820,13218,39650,75135,58468,61066,15656,481,69340,31966,94623,21364,54057,88430,73016,2489,25596,33133,54104,24789,91081,26048,92369,27253,78272,29925,65495,42690,81905,31777,28651,85758,58256,55701,72395,65532,46557,98794,70412,33179,54996,98848,32228,97724,38179,55991,55434,15537,35205,42677,67864,79170,85018,82455,30783,61700,81986,82743,31965,14018,5062,95248,37243,33233,65227,54345,64963,5406,16342,35779,55222,79878,5108,14047,62457,67680,47406,72181,58059,92345,78128,65488,71593,5373,40258,74601,7363,23184,44997,77811,4516,88083,22049,58168,69444,26214,70400,46662,90038,38584,61574,976,61014,91194,66755,78118,21621,31231,67366,77470,95497,40049,31673,30311,12409,18755,12352,4609,10365,12874,45718,48559,37264,97664,65903,59830,3204,85250,46939,30647,18685,28637,45420,83751,81401,10090,19911,81686,71115,20924,14298,69803,53680,60019,25553,99650,42678,37848,26704,71183,77050,17802,85470,54488,48405,68705,86310,77316,8108,92834,88435,33352,58226,45151,91771,31535,59942,96465,5344,81675,28650,20417,35348,4066,41649,70796,25919,36626,15724,35507,44882,55095,23046,12013,48827,45027,29757,89136,57039,48745,95876,57553,6070,50572,97151,8129,47346,6347,78077,23919,81209,55360,17959,38722,77794,43346,42668,93731,80028,42193,77710,47867,93872,66582,87592,13514,9137,14233,4796,6425,72657,20134,42485,57012,93663,55098,72337,6747,97737,28016,37787,99394,42956,56489,47039,89079,57893,51857,526,72750,3563,30050,45440,54488,97586,636,23952,44869,43013,62752,1393,93582,43909,14576,52494,11873,29871,19654,73456,92683,87163,37141,68871,96376,73596,30377,42730,83024,90724,14430,52499,97391,65626,84809,43991,2548,54386,23649,79842,84324,48179,81669,16714,99904,66655,16687,67778,77256,63536,13950,75178,54564,97874,71190,6719,26178,40041,54633,14486,4025,61498,33945,655,21646,23111,77325,24473,32671,21521,8587,23373,63621,20624,39809,40749,89062,47289,81698,96309,40385,10336,74196,43753,48540,31745,49851,65536,22596,77260,33584,30337,53451,96008,82641,31682,40735,1768,76068,58969,72791,20497,95575,24775,23079,17681,84050,90863,21028,54798,28877,40251,90277,26201,93694,85480,90895,38149,81815,43690,69329,41129,71395,77663,7406,40919,16499,30954,75702,79541,68217,65741,55639,13708,42878,26213,9045,57842,66320,34931,26165,72471,33649,74519,82384,4050,61559,61646,66352,20838,59166,40601,18102,82666,24381,89491,99718,89076,64115,98144,65284,33308,43938,7945,15751,37619,61638,24672,19799,35425,45705,15268,72681,92124,73902,72210,86989,1964,9481,11221,84497,11149,75727,44266,96256,18016,18354,47713,49487,50699,77126,18571,27572,72144,43402,59840,57654,96970,65052,6870,60585,11123,70402,805,85751,29056,2814,80757,54526,15424,18182,95064,50909,56632,61400,36108,12407,97589,69742,59023,28572,43648,43641,46635,84741,52046,19580,15888,75449,4285,38220,85055,27076,12021,48417,34618,25220,3857,90665,2952,35566,81710,60689,48395,92010,45463,3611,21663,4413,84202,88115,69632,84622,95645,20065,72141,54104,78579,213,80944,29643,15135,90792,98914,30005,23928,83398,96173,8051,3988,64799,54359,32877,10358,63390,70797,78038,12179,67799,91069,52602,8040,56466,61621,94251,14461,89052,57188,11505,53800,15290,47794,44249,95422,86868,79849,12332,21827,92221,24603,49930,82193,4293,37594,65722,20674,85859,17155,35636,60498,30204,53980,54365,2288,70626,3603,85815,28062,16812,55961,59271,15206,65937,28360,8313,94632,75145,53484,92607,15670,85555,50374,36020,77531,3709,93245,13145,19098,75872,44399,28030,77906,60696,8685,69016,35641,6523,88303,29736,97940,71796,66870,85434,47387,28149,55941,64095,84641,31596,79330,524,94087,14943,39504,60427,65366,98157,33697,97294,62687,24203,26290,43060,44369,70734,53820,7097,89435,46018,53284,82586,40512,30524,3792,30118,90537,43321,84591,48201,94207,12079,43990,67451,63208,91078,12146,79661,24765,59406,98350,21188,50965,47052,11134,589,22594,75027,63345,90560,21715,7600,86191,34871,13362,9189,20753,11394,89261,55060,69007,5356,39341,65233,27115,80437,34011,20728,46155,42030,57400,25130,18796,66093]))